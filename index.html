
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>UndressIt</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="What is this, do I have too many clothes on?">
  <meta name="theme-color" content="#071f1a">

  <!-- Google Fonts: Inter -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg-1: hsl(171 36% 8%);   /* deep teal */
      --bg-2: hsl(162 32% 10%);  /* forest teal */
      --bg-3: hsl(158 30% 12%);  /* deep green */

      --text: hsl(160 16% 96%);
      --subtext: hsl(160 12% 84%);

      --accent-rgb: 16 185 129;  /* emerald */
      --accent2-rgb: 20 184 166; /* teal */

      --surface: hsl(165 20% 16%);
      --surface-2: hsl(165 20% 18%);
      --border: hsl(165 14% 28%);
      --radius: 12px;
      --shadow-lg: 0 18px 50px rgba(0, 0, 0, 0.45);
      --focus-ring: 0 0 0 2px rgb(var(--accent-rgb) / 0.9), 0 0 0 6px rgb(var(--accent-rgb) / 0.18);
    }

    *, *::before, *::after { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      color: var(--text);
      background: linear-gradient(120deg, var(--bg-1), var(--bg-2) 50%, var(--bg-3) 100%);
      font-family: "Inter", system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
      text-rendering: optimizeLegibility;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    #bg-eyes {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
      display: block;
    }

    main {
      min-height: 100dvh;
      display: grid;
      place-items: center;
      padding: 32px 20px;
    }
    .container {
      width: min(92vw, 860px);
      display: grid;
      gap: 24px;
      background: rgba(10, 18, 16, 0.30);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow-lg);
      backdrop-filter: blur(8px) saturate(1.05);
      padding: 28px 28px 24px;
      position: relative; /* keeps hit testing clear for spawn area */
    }

    .eyebrow {
      display: inline-block;
      font-size: 12px;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      color: rgb(var(--accent-rgb));
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid rgba(255, 255, 255, 0.06);
      border-radius: 999px;
      padding: 6px 10px;
      user-select: none;
    }
    h1 {
      font-size: clamp(32px, 5vw, 64px);
      line-height: 1.05;
      margin: 6px 0 10px;
      font-weight: 700;
      letter-spacing: -0.01em;
      color: var(--text);
      text-shadow: 0 1px 1px rgba(0,0,0,0.35);
    }
    .subtext {
      color: var(--subtext);
      font-size: clamp(14px, 1.8vw, 18px);
      line-height: 1.5;
      display: grid;
      gap: 6px;
      text-shadow: 0 1px 1px rgba(0,0,0,0.35);
    }

    .cta-row {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 12px;
      margin-top: 4px;
    }
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      width: 100%;
      padding: 14px 16px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      text-decoration: none;
      font-weight: 600;
      color: var(--text);
      background: linear-gradient(180deg, var(--surface), var(--surface-2));
      transition: transform 80ms ease, border-color 160ms ease, background-color 160ms ease, color 160ms ease, box-shadow 160ms ease;
    }
    .btn:hover {
      border-color: rgba(255, 255, 255, 0.22);
      background: linear-gradient(180deg, var(--surface-2), hsl(165 22% 20%));
    }
    .btn:active { transform: translateY(0.8px) scale(0.998); }
    .btn:focus-visible {
      outline: none;
      box-shadow: var(--focus-ring);
      border-color: rgb(var(--accent-rgb));
    }
    .btn.primary {
      background:
        linear-gradient(180deg, rgba(255,255,255,0.03), rgba(0,0,0,0.06)),
        linear-gradient(180deg, rgb(var(--accent-rgb) / 0.18), rgb(var(--accent-rgb) / 0.12));
      border-color: rgb(var(--accent-rgb) / 0.55);
    }
    .btn.primary:hover {
      background:
        linear-gradient(180deg, rgba(255,255,255,0.04), rgba(0,0,0,0.08)),
        linear-gradient(180deg, rgb(var(--accent-rgb) / 0.24), rgb(var(--accent-rgb) / 0.16));
      border-color: rgb(var(--accent-rgb) / 0.8);
    }

    .contract-strip {
      margin-top: 8px;
      display: grid;
      grid-template-columns: 1fr auto;
      align-items: center;
      gap: 12px;
      background: rgba(255, 255, 255, 0.04);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 12px;
    }
    .contract-meta { display: grid; gap: 6px; }
    .contract-label {
      font-size: 12px;
      color: hsl(160 10% 76%);
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }
    .contract-value {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 14px;
      color: var(--text);
      word-break: break-all;
      user-select: all;
    }
    .copy-btn {
      padding: 10px 14px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: linear-gradient(180deg, var(--surface), var(--surface-2));
      color: var(--text);
      font-weight: 600;
      cursor: pointer;
      transition: transform 80ms ease, border-color 160ms ease, background 160ms ease, box-shadow 160ms ease;
      white-space: nowrap;
    }
    .copy-btn:hover { border-color: rgba(255,255,255,0.22); }
    .copy-btn:active { transform: translateY(0.8px); }
    .copy-btn:focus-visible { outline: none; box-shadow: var(--focus-ring); border-color: rgb(var(--accent-rgb)); }

    .extra-actions {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
      width: 100%;
      justify-self: stretch;
      margin-top: 4px;
    }

    .fab-x {
      position: fixed;
      right: 24px;
      bottom: 24px;
      width: 56px;
      height: 56px;
      border-radius: 9999px;
      background: linear-gradient(180deg, var(--surface), var(--surface-2));
      border: 1px solid var(--border);
      color: var(--text);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      text-decoration: none;
      box-shadow: 0 10px 30px rgba(0,0,0,0.35);
      transition: transform 120ms ease, border-color 160ms ease, box-shadow 160ms ease, background 160ms ease;
      z-index: 10;
    }
    .fab-x:hover {
      border-color: rgba(255,255,255,0.25);
      box-shadow: 0 14px 40px rgba(0,0,0,0.45), 0 0 0 6px rgb(var(--accent-rgb) / 0.12) inset;
      transform: translateY(-1px);
    }
    .fab-x:focus-visible {
      outline: none;
      box-shadow: var(--focus-ring), 0 10px 30px rgba(0,0,0,0.35);
    }
    .fab-x svg {
      width: 22px;
      height: 22px;
      display: block;
    }

    footer {
      width: min(92vw, 860px);
      margin: 20px auto 36px;
      color: hsl(160 12% 78%);
      font-size: 13px;
      line-height: 1.55;
      text-shadow: 0 1px 1px rgba(0,0,0,0.25);
    }
    footer a {
      color: rgb(var(--accent2-rgb));
      text-decoration: none;
      border-bottom: 1px dashed transparent;
    }
    footer a:hover { color: rgb(var(--accent-rgb)); border-color: rgb(var(--accent-rgb) / 0.4); }
    footer a:focus-visible { outline: none; box-shadow: var(--focus-ring); border-radius: 6px; padding: 2px 4px; }

    .visually-hidden {
      position: absolute !important;
      height: 1px; width: 1px;
      overflow: hidden; clip: rect(1px, 1px, 1px, 1px);
      white-space: nowrap; border: 0; padding: 0; margin: -1px;
    }

    @media (max-width: 720px) {
      .cta-row { grid-template-columns: 1fr; }
      .contract-strip {
        grid-template-columns: 1fr;
        gap: 10px;
      }
      .copy-btn { width: 100%; }
      .container { padding: 22px 18px 18px; }
      .fab-x { right: 18px; bottom: 18px; width: 52px; height: 52px; }
    }
  </style>
</head>
<body>
  <canvas id="bg-eyes" aria-hidden="true"></canvas>

  <main>
    <section class="container" id="spawn-container" aria-labelledby="hero-heading">
      <span class="eyebrow" aria-hidden="true">$WOAH!</span>

      <h1 id="hero-heading">Like XRAY, but better. WEB3 OPAQUE ASSET HINDSIGHT. $WOAH.</h1>

      <div class="subtext">
        <p>Pay to undress them.</p>
        <p>Hold to $WOAH.</p>
      </div>

      <nav class="cta-row" aria-label="Primary calls to action">
        <!-- TIP: Update hrefs for your real destinations -->
        <a class="btn primary" href="pump.fun" target="_blank" rel="noopener noreferrer" aria-label="Buy now (opens in a new tab)">Buy Now</a>
        <a class="btn" href="dexscreener.com" target="_blank" rel="noopener noreferrer" aria-label="View on DEX Screener (opens in a new tab)">View on DEX Screener</a>
      </nav>

      <div class="contract-strip" role="group" aria-labelledby="contract-label">
        <div class="contract-meta">
          <span class="contract-label" id="contract-label">Contract Address</span>
          <div class="contract-value" id="contract-address" data-address="mycontract">mycontract</div>
        </div>
        <button class="copy-btn" id="copy-button" type="button" aria-live="polite" aria-label="Copy contract address to clipboard">Copy</button>
      </div>

      <nav class="extra-actions" aria-label="Extra actions">
        <!-- TIP: Update label and href -->
        <a class="btn" href="web.telegram.org" target="_blank" aria-label="TRY IT">TRY IT</a>
      </nav>
    </section>
  </main>

  <a class="fab-x" href="https://twitter.com/your-handle" target="_blank" rel="noopener noreferrer" title="Want to CTO?" aria-label="Twitter">
    <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
      <path fill="currentColor" d="M18.3 2h3.2L14 10.3l8.2 11.7h-6.5L12 14.7 6.2 22H2.8L10 12.9 2 2h6.5l4.7 6.8L18.3 2z"/>
    </svg>
  </a>

  <footer>
    <p>
      No community. No tokenomics. Just send nudes.
    <p>
    <p>
      Disclaimer: Use with caution. In case of extreme usage, <a href="https://i.kym-cdn.com/entries/icons/original/000/033/758/Screen_Shot_2020-04-28_at_12.21.48_PM.png" target="_blank">click here.</a> No rights reserved.
    </p>
  </footer>

  <div class="visually-hidden" role="status" aria-live="polite" id="sr-feedback"></div>

  <script>
    (function () {
      const canvas = document.getElementById('bg-eyes');
      const ctx = canvas.getContext('2d', { alpha: true });

      const container = document.getElementById('spawn-container');

      const mqReduced = window.matchMedia('(prefers-reduced-motion: reduce)');
      const hasReduced = mqReduced.matches;
      const mqFine = window.matchMedia('(pointer: fine)');

      const yearEl = document.getElementById('year');
      if (yearEl) yearEl.textContent = new Date().getFullYear();

      const copyBtn = document.getElementById('copy-button');
      const addrEl = document.getElementById('contract-address');
      const srFeedback = document.getElementById('sr-feedback');

      function setFeedback(text) {
        if (copyBtn) copyBtn.textContent = text;
        if (srFeedback) srFeedback.textContent = text;
      }
      async function copyAddress() {
        const address = (addrEl?.dataset.address || addrEl?.textContent || '').trim();
        if (!address) return;

        let success = false;
        try {
          if (navigator.clipboard && navigator.clipboard.writeText) {
            await navigator.clipboard.writeText(address);
            success = true;
          } else {
            throw new Error('Clipboard API not available');
          }
        } catch {
          try {
            const ta = document.createElement('textarea');
            ta.value = address;
            ta.setAttribute('readonly', '');
            ta.style.position = 'fixed';
            ta.style.top = '-9999px';
            document.body.appendChild(ta);
            ta.select();
            success = document.execCommand && document.execCommand('copy');
            document.body.removeChild(ta);
          } catch {
            success = false;
          }
        }
        const originalText = 'Copy';
        setFeedback(success ? 'Copied!' : 'Copy failed');
        window.setTimeout(() => setFeedback(originalText), 1200);
      }
      if (copyBtn) copyBtn.addEventListener('click', copyAddress);

      let dpr = 1;

      function sizeCanvas() {
        dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1)); // cap DPR for performance
        const w = window.innerWidth;
        const h = window.innerHeight;
        canvas.width = Math.floor(w * dpr);
        canvas.height = Math.floor(h * dpr);
        canvas.style.width = w + 'px';
        canvas.style.height = h + 'px';
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);

        updateContainerRect();
        relayoutAllPairs();
        if (hasReduced) drawOnce();
      }

      let containerRect = container.getBoundingClientRect();

      function updateContainerRect() {
        containerRect = container.getBoundingClientRect();
      }

      const pairs = [];
      let baseRadius = 40;

      function computeBaseRadius() {
        const w = canvas.clientWidth;
        const h = canvas.clientHeight;
        baseRadius = Math.max(24, Math.min(80, Math.floor(Math.min(w, h) * 0.08)));
      }

      const overflowFraction = 0.4; // 40%

      function clampPairCenterToContainer(center, r, sep) {
        const insideMargin = r * (1 - overflowFraction); // 0.6 * r

        const cxMin = (containerRect.left + insideMargin) + sep / 2;
        const cxMax = (containerRect.right - insideMargin) - sep / 2;

        const cyMin = containerRect.top + insideMargin;
        const cyMax = containerRect.bottom - insideMargin;

        const minX = Math.min(cxMin, cxMax);
        const maxX = Math.max(cxMin, cxMax);
        const minY = Math.min(cyMin, cyMax);
        const maxY = Math.max(cyMin, cyMax);

        center.x = Math.min(Math.max(center.x, minX), maxX);
        center.y = Math.min(Math.max(center.y, minY), maxY);
        return center;
      }

      function createPairAt(x, y) {
        computeBaseRadius();
        const r = baseRadius;

        const gap = -Math.floor(r * 0.35);
        const separation = r * 2 + gap;

        const center = clampPairCenterToContainer({ x, y }, r, separation);

        const leftCx = center.x - separation / 2;
        const rightCx = center.x + separation / 2;
        const cy = center.y;

        const pupilR = Math.floor(r * 0.38);
        const margin = Math.max(2, Math.floor(r * 0.04));

        const pair = {
          center,
          r,
          separation,
          pupilR,
          margin,
          lineW: Math.max(2, Math.min(4, Math.floor(r * 0.06))), 
          eyes: [
            { cx: leftCx, cy, r, pupil: { x: leftCx, y: cy } }, 
            { cx: rightCx, cy, r, pupil: { x: rightCx, y: cy } } 
          ]
        };
        pairs.push(pair);
      }

      function relayoutPair(pair) {
        computeBaseRadius();
        pair.r = baseRadius;
        pair.pupilR = Math.floor(pair.r * 0.38);
        pair.margin = Math.max(2, Math.floor(pair.r * 0.04));
        const gap = -Math.floor(pair.r * 0.35);
        pair.separation = pair.r * 2 + gap;
        pair.lineW = Math.max(2, Math.min(4, Math.floor(pair.r * 0.06)));

        clampPairCenterToContainer(pair.center, pair.r, pair.separation);

        const leftCx = pair.center.x - pair.separation / 2;
        const rightCx = pair.center.x + pair.separation / 2;
        const cy = pair.center.y;

        pair.eyes[0].cx = leftCx; pair.eyes[0].cy = cy; pair.eyes[0].r = pair.r;
        pair.eyes[1].cx = rightCx; pair.eyes[1].cy = cy; pair.eyes[1].r = pair.r;

        pair.eyes[0].pupil.x = leftCx; pair.eyes[0].pupil.y = cy;
        pair.eyes[1].pupil.x = rightCx; pair.eyes[1].pupil.y = cy;
      }

      function relayoutAllPairs() {
        for (let i = 0; i < pairs.length; i++) relayoutPair(pairs[i]);
      }

      function containerCenter() {
        return {
          x: containerRect.left + containerRect.width / 2,
          y: containerRect.top + containerRect.height * 0.42
        };
      }
      updateContainerRect();
      const c0 = containerCenter();
      createPairAt(c0.x, c0.y);

      let autopilot = !mqFine.matches; 
      let pointerX = c0.x;
      let pointerY = c0.y;

      function onPointerMove(ev) {
        if (hasReduced) return; 
        autopilot = false;
        pointerX = ev.clientX;
        pointerY = ev.clientY;
        if (!running) start();
      }
      function onPointerLeave() {
        if (hasReduced) return;
        const c = containerCenter();
        pointerX = c.x;
        pointerY = c.y;
        if (!running) start();
      }


      function onContainerPointerDown(ev) {
        const x = ev.clientX;
        const y = ev.clientY;
        updateContainerRect();
        if (
          x >= containerRect.left && x <= containerRect.right &&
          y >= containerRect.top && y <= containerRect.bottom
        ) {
          createPairAt(x, y);
          pointerX = x;
          pointerY = y;
          if (hasReduced) drawOnce();
          else if (!running) start();
        }
      }

      function autoTarget(time) {
        const cx = containerRect.left + containerRect.width / 2;
        const cy = containerRect.top + containerRect.height / 2;
        const ax = (Math.sin(time * 0.6) + Math.sin(time * 0.31 + 1.1)) * 0.25;
        const ay = (Math.cos(time * 0.43) + Math.sin(time * 0.21 + 0.7)) * 0.25;
        const maxX = Math.min(containerRect.width * 0.25, 160);
        const maxY = Math.min(containerRect.height * 0.22, 140);
        pointerX = cx + maxX * ax;
        pointerY = cy + maxY * ay;
      }

      function lerp(a, b, t) { return a + (b - a) * t; }

      function drawEyeball(eye, lineW) {
        const { cx, cy, r } = eye;

        ctx.save();
        ctx.beginPath();
        ctx.arc(cx, cy, r, 0, Math.PI * 2);
        ctx.shadowColor = 'rgba(0, 0, 0, 0.35)';
        ctx.shadowBlur = r * 0.6;
        ctx.shadowOffsetY = r * 0.12;
        ctx.fillStyle = 'rgba(0,0,0,0)'; // shadow only
        ctx.fill();
        ctx.restore();

        ctx.beginPath();
        ctx.arc(cx, cy, r, 0, Math.PI * 2);
        ctx.fillStyle = 'rgba(250, 214, 190, 0.98)'; 
        ctx.fill();
        ctx.lineWidth = lineW; 
        ctx.strokeStyle = 'rgba(0,0,0,0.9)';
        ctx.stroke();

        const gH = ctx.createRadialGradient(cx - r * 0.35, cy - r * 0.35, 0, cx - r * 0.35, cy - r * 0.35, r);
        gH.addColorStop(0.0, 'rgba(255,255,255,0.38)');
        gH.addColorStop(0.5, 'rgba(255,255,255,0.12)');
        gH.addColorStop(1.0, 'rgba(255,255,255,0.00)');
        ctx.fillStyle = gH;
        ctx.beginPath();
        ctx.arc(cx, cy, r, 0, Math.PI * 2);
        ctx.fill();

        const gS = ctx.createRadialGradient(cx + r * 0.35, cy + r * 0.35, 0, cx + r * 0.35, cy + r * 0.35, r);
        gS.addColorStop(0.0, 'rgba(0,0,0,0.24)');
        gS.addColorStop(0.6, 'rgba(0,0,0,0.10)');
        gS.addColorStop(1.0, 'rgba(0,0,0,0.00)');
        ctx.fillStyle = gS;
        ctx.beginPath();
        ctx.arc(cx, cy, r, 0, Math.PI * 2);
        ctx.fill();

        const rim = ctx.createRadialGradient(cx, cy, r * 0.6, cx, cy, r);
        rim.addColorStop(0, 'rgba(0,0,0,0)');
        rim.addColorStop(1, 'rgba(0,0,0,0.14)');
        ctx.fillStyle = rim;
        ctx.beginPath();
        ctx.arc(cx, cy, r, 0, Math.PI * 2);
        ctx.fill();
      }

      function drawPupil(eye, pupilR, lineW) {
        const px = eye.pupil.x;
        const py = eye.pupil.y;

        const pg = ctx.createRadialGradient(px, py, 0, px, py, pupilR);
        pg.addColorStop(0.0, 'rgba(255, 79, 138, 1)'); 
        pg.addColorStop(0.6, 'rgba(255, 112, 158, 0.92)');
        pg.addColorStop(1.0, 'rgba(255, 158, 188, 0.85)');
        ctx.fillStyle = pg;
        ctx.beginPath();
        ctx.arc(px, py, pupilR, 0, Math.PI * 2);
        ctx.fill();
        ctx.lineWidth = lineW;
        ctx.strokeStyle = 'rgba(0,0,0,0.9)';
        ctx.stroke();

        const hr = Math.max(2, pupilR * 0.22);
        ctx.beginPath();
        ctx.arc(px, py, hr, 0, Math.PI * 2);
        ctx.fillStyle = 'rgba(255, 192, 203, 0.96)';
        ctx.fill();
        ctx.lineWidth = Math.max(1.6, lineW * 0.8);
        ctx.strokeStyle = 'rgba(0,0,0,0.9)';
        ctx.stroke();
      }

      function updatePupils() {
        for (let i = 0; i < pairs.length; i++) {
          const pair = pairs[i];
          const { pupilR, margin } = pair;
          for (let j = 0; j < pair.eyes.length; j++) {
            const eye = pair.eyes[j];
            const { cx, cy, r } = eye;

            const dx = pointerX - cx;
            const dy = pointerY - cy;
            const dist = Math.hypot(dx, dy) || 1;
            const maxOffset = Math.max(0, r - pupilR - margin);
            const ux = dx / dist;
            const uy = dy / dist;
            const tx = cx + ux * Math.min(dist, maxOffset);
            const ty = cy + uy * Math.min(dist, maxOffset);

            // Easing
            eye.pupil.x = lerp(eye.pupil.x, tx, 0.18);
            eye.pupil.y = lerp(eye.pupil.y, ty, 0.18);
          }
        }
      }

      function drawEyesFrameTwoPass() {
        const w = canvas.clientWidth, h = canvas.clientHeight;
        ctx.clearRect(0, 0, w, h);

        for (let i = 0; i < pairs.length; i++) {
          const pair = pairs[i];
          drawEyeball(pair.eyes[0], pair.lineW); 
          drawEyeball(pair.eyes[1], pair.lineW); 
        }


        for (let i = 0; i < pairs.length; i++) {
          const pair = pairs[i];
          drawPupil(pair.eyes[0], pair.pupilR, pair.lineW);
          drawPupil(pair.eyes[1], pair.pupilR, pair.lineW);
        }
      }

      function drawStaticFrameTwoPass() {
        const w = canvas.clientWidth, h = canvas.clientHeight;
        ctx.clearRect(0, 0, w, h);

        for (let i = 0; i < pairs.length; i++) {
          const pair = pairs[i];
          pair.eyes[0].pupil.x = pair.eyes[0].cx; pair.eyes[0].pupil.y = pair.eyes[0].cy;
          pair.eyes[1].pupil.x = pair.eyes[1].cx; pair.eyes[1].pupil.y = pair.eyes[1].cy;
        }

        for (let i = 0; i < pairs.length; i++) {
          const pair = pairs[i];
          drawEyeball(pair.eyes[0], pair.lineW);
          drawEyeball(pair.eyes[1], pair.lineW);
        }

        for (let i = 0; i < pairs.length; i++) {
          const pair = pairs[i];
          drawPupil(pair.eyes[0], pair.pupilR, pair.lineW);
          drawPupil(pair.eyes[1], pair.pupilR, pair.lineW);
        }
      }

      function drawOnce() { drawStaticFrameTwoPass(); }

      let running = false;
      let raf = 0;
      function draw(t) {
        const time = t * 0.001;

        if (autopilot && !hasReduced) {
          autoTarget(time);
        }

        updatePupils();

        drawEyesFrameTwoPass();

        if (!hasReduced) {
          raf = requestAnimationFrame(draw);
        } else {
          running = false;
        }
      }
      function start() {
        if (running || hasReduced) return;
        running = true;
        cancelAnimationFrame(raf);
        raf = requestAnimationFrame(draw);
      }

      sizeCanvas();
      if (!hasReduced) start();
      else drawOnce();

      window.addEventListener('resize', () => {
        sizeCanvas();
      }, { passive: true });

      window.addEventListener('scroll', () => {
        updateContainerRect();
        relayoutAllPairs();
        if (hasReduced) drawOnce();
      }, { passive: true });

      window.addEventListener('pointermove', onPointerMove, { passive: true });
      window.addEventListener('pointerleave', onPointerLeave, { passive: true });

      container.addEventListener('pointerdown', onContainerPointerDown, { passive: true });
    })();
  </script>
</body>
</html>

