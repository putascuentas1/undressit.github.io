
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>$WOAH â€” Web3 opaque asset hindsight</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Interactive landing with realtime floating messages and animated eyes background.">
  <meta name="theme-color" content="#071f1a">

  <!-- Fonts: Inter (UI), Space Grotesk (hero), Manrope (subtext) -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Manrope:wght@400;600;700&family=Space+Grotesk:wght@700;800&display=swap" rel="stylesheet">

  <!-- Supabase JS v2 UMD (jsDelivr) -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>

  <!-- Favicon (SVG injected as Blob so no separate file is needed) -->
  <link id="dynamic-favicon" rel="icon" type="image/svg+xml">
  <script>
    // Inject the provided SVG favicon (sideways-U highlights y=112.2/127.8, arc radius 7.8)
    (function injectFavicon() {
      var svg = `
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 460 240">
  <defs>
    <filter id="dropShadow" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur in="SourceAlpha" stdDeviation="8" result="blur"/>
      <feOffset in="blur" dx="0" dy="8" result="off"/>
      <feMerge><feMergeNode in="off"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
    <radialGradient id="hl-left" gradientUnits="userSpaceOnUse" cx="147.5" cy="95.5" r="70">
      <stop offset="0" stop-color="#FFFFFF" stop-opacity="0.38"/>
      <stop offset="0.5" stop-color="#FFFFFF" stop-opacity="0.12"/>
      <stop offset="1" stop-color="#FFFFFF" stop-opacity="0"/>
    </radialGradient>
    <radialGradient id="sh-left" gradientUnits="userSpaceOnUse" cx="196.5" cy="144.5" r="70">
      <stop offset="0" stop-color="#000000" stop-opacity="0.24"/>
      <stop offset="0.6" stop-color="#000000" stop-opacity="0.10"/>
      <stop offset="1" stop-color="#000000" stop-opacity="0"/>
    </radialGradient>
    <radialGradient id="rim-left" gradientUnits="userSpaceOnUse" cx="172" cy="120" r="70">
      <stop offset="0" stop-color="#000000" stop-opacity="0"/>
      <stop offset="1" stop-color="#000000" stop-opacity="0.14"/>
    </radialGradient>
    <radialGradient id="hl-right" gradientUnits="userSpaceOnUse" cx="263.5" cy="95.5" r="70">
      <stop offset="0" stop-color="#FFFFFF" stop-opacity="0.38"/>
      <stop offset="0.5" stop-color="#FFFFFF" stop-opacity="0.12"/>
      <stop offset="1" stop-color="#FFFFFF" stop-opacity="0"/>
    </radialGradient>
    <radialGradient id="sh-right" gradientUnits="userSpaceOnUse" cx="312.5" cy="144.5" r="70">
      <stop offset="0" stop-color="#000000" stop-opacity="0.24"/>
      <stop offset="0.6" stop-color="#000000" stop-opacity="0.10"/>
      <stop offset="1" stop-color="#000000" stop-opacity="0"/>
    </radialGradient>
    <radialGradient id="rim-right" gradientUnits="userSpaceOnUse" cx="288" cy="120" r="70">
      <stop offset="0" stop-color="#000000" stop-opacity="0"/>
      <stop offset="1" stop-color="#000000" stop-opacity="0.14"/>
    </radialGradient>
    <radialGradient id="pupil-left" gradientUnits="userSpaceOnUse" cx="134" cy="120" r="26.6">
      <stop offset="0" stop-color="#FF4F8A" stop-opacity="1"/>
      <stop offset="0.6" stop-color="#FF709E" stop-opacity="0.92"/>
      <stop offset="1" stop-color="#FF9EBC" stop-opacity="0.85"/>
    </radialGradient>
    <radialGradient id="pupil-right" gradientUnits="userSpaceOnUse" cx="250" cy="120" r="26.6">
      <stop offset="0" stop-color="#FF4F8A" stop-opacity="1"/>
      <stop offset="0.6" stop-color="#FF709E" stop-opacity="0.92"/>
      <stop offset="1" stop-color="#FF9EBC" stop-opacity="0.85"/>
    </radialGradient>
  </defs>
  <g filter="url(#dropShadow)" stroke="#000" stroke-opacity="0.9" stroke-width="5" stroke-linejoin="round">
    <circle cx="172" cy="120" r="70" fill="#FAD6BE" fill-opacity="0.98"/>
    <circle cx="172" cy="120" r="70" fill="url(#hl-left)" stroke="none"/>
    <circle cx="172" cy="120" r="70" fill="url(#sh-left)" stroke="none"/>
    <circle cx="172" cy="120" r="70" fill="url(#rim-left)" stroke="none"/>
    <circle cx="288" cy="120" r="70" fill="#FAD6BE" fill-opacity="0.98"/>
    <circle cx="288" cy="120" r="70" fill="url(#hl-right)" stroke="none"/>
    <circle cx="288" cy="120" r="70" fill="url(#sh-right)" stroke="none"/>
    <circle cx="288" cy="120" r="70" fill="url(#rim-right)" stroke="none"/>
  </g>
  <g stroke="#000" stroke-opacity="0.9" stroke-width="5" stroke-linejoin="round">
    <circle cx="134" cy="120" r="26.6" fill="url(#pupil-left)"/>
    <circle cx="250" cy="120" r="26.6" fill="url(#pupil-right)"/>
  </g>
  <g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="#000" stroke-opacity="0.9" stroke-width="6">
    <path d="M 136.2 112.2 H 126.2 A 7.8 7.8 0 0 0 126.2 127.8 H 136.2"/>
    <path d="M 252.2 112.2 H 242.2 A 7.8 7.8 0 0 0 242.2 127.8 H 252.2"/>
  </g>
</svg>`;
      try {
        var blob = new Blob([svg.trim()], { type: 'image/svg+xml' });
        var url = URL.createObjectURL(blob);
        var link = document.getElementById('dynamic-favicon');
        if (link) link.href = url;
      } catch (e) {
        var link = document.getElementById('dynamic-favicon');
        if (link) link.href = 'data:image/svg+xml;utf8,' + encodeURIComponent(svg);
      }
    })();
  </script>

  <style>
    :root {
      --bg-1: hsl(171 36% 8%);
      --bg-2: hsl(162 32% 10%);
      --bg-3: hsl(158 30% 12%);

      --text: hsl(160 16% 96%);
      --subtext: hsl(160 12% 84%);

      --accent-rgb: 16 185 129;
      --accent2-rgb: 20 184 166;

      --surface: hsl(165 20% 16%);
      --surface-2: hsl(165 20% 18%);
      --border: hsl(165 14% 28%);
      --radius: 12px;
      --shadow-lg: 0 18px 50px rgba(0, 0, 0, 0.45);
      --focus-ring: 0 0 0 2px rgb(var(--accent-rgb) / 0.9), 0 0 0 6px rgb(var(--accent-rgb) / 0.18);

      --skin: #FAD6BE; /* bubble fill and eye skin color */
    }

    *, *::before, *::after { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      color: var(--text);
      background: linear-gradient(120deg, var(--bg-1), var(--bg-2) 50%, var(--bg-3) 100%);
      font-family: "Inter", system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
      text-rendering: optimizeLegibility;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* Eyes background canvas */
    #bg-eyes {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
      display: block;
    }

    main {
      min-height: 100dvh;
      display: grid;
      place-items: center;
      padding: 32px 20px;
    }

    .container {
      width: min(92vw, 860px);
      display: grid;
      gap: 24px;
      background: rgba(10, 18, 16, 0.30);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow-lg);
      backdrop-filter: blur(8px) saturate(1.05);
      padding: 28px 28px 24px;
      position: relative;
    }

    /* Hero typography: three centered lines */
    h1 {
      font-family: "Space Grotesk", "Inter", system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
      font-size: clamp(38px, 6.5vw, 72px);
      line-height: 1.06;
      margin: 6px 0 6px;
      font-weight: 800;
      letter-spacing: -0.01em;
      color: var(--text);
      text-shadow: 0 1px 1px rgba(0,0,0,0.35);
      text-align: center;
    }
    .hero-lines { display: inline-grid; gap: 4px; }
    .hero-line { display: block; }
    .hero-tag {
      display: block;
      margin-top: 6px;
      font-size: clamp(30px, 5.5vw, 56px);
      font-weight: 800;
      color: rgb(var(--accent-rgb));
      text-shadow: 0 1px 1px rgba(0,0,0,0.35);
    }

    .subtext {
      font-family: "Manrope", "Inter", system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
      color: var(--subtext);
      font-size: clamp(15px, 2vw, 20px);
      line-height: 1.6;
      display: grid;
      gap: 6px;
      text-shadow: 0 1px 1px rgba(0,0,0,0.35);
      text-align: center;
    }

    .cta-row {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 12px;
      margin-top: 4px;
    }
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      width: 100%;
      padding: 14px 16px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      text-decoration: none;
      font-weight: 600;
      color: var(--text);
      background: linear-gradient(180deg, var(--surface), var(--surface-2));
      transition: transform 80ms ease, border-color 160ms ease, background-color 160ms ease, color 160ms ease, box-shadow 160ms ease;
    }
    .btn:hover {
      border-color: rgba(255, 255, 255, 0.22);
      background: linear-gradient(180deg, var(--surface-2), hsl(165 22% 20%));
    }
    .btn:active { transform: translateY(0.8px) scale(0.998); }
    .btn:focus-visible { outline: none; box-shadow: var(--focus-ring); border-color: rgb(var(--accent-rgb)); }
    .btn.primary {
      background:
        linear-gradient(180deg, rgba(255,255,255,0.03), rgba(0,0,0,0.06)),
        linear-gradient(180deg, rgb(var(--accent-rgb) / 0.18), rgb(var(--accent-rgb) / 0.12));
      border-color: rgb(var(--accent-rgb) / 0.55);
    }
    .btn.primary:hover {
      background:
        linear-gradient(180deg, rgba(255,255,255,0.04), rgba(0,0,0,0.08)),
        linear-gradient(180deg, rgb(var(--accent-rgb) / 0.24), rgb(var(--accent-rgb) / 0.16));
      border-color: rgb(var(--accent-rgb) / 0.8);
    }

    .contract-strip {
      margin-top: 8px;
      display: grid;
      grid-template-columns: 1fr auto;
      align-items: center;
      gap: 12px;
      background: rgba(255, 255, 255, 0.04);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 12px;
    }
    .contract-meta { display: grid; gap: 6px; }
    .contract-label {
      font-size: 12px;
      color: hsl(160 10% 76%);
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }
    .contract-value {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 14px;
      color: var(--text);
      word-break: break-all;
      user-select: all;
    }
    .copy-btn {
      padding: 10px 14px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: linear-gradient(180deg, var(--surface), var(--surface-2));
      color: var(--text);
      font-weight: 600;
      cursor: pointer;
      transition: transform 80ms ease, border-color 160ms ease, background 160ms ease, box-shadow 160ms ease;
      white-space: nowrap;
    }
    .copy-btn:hover { border-color: rgba(255,255,255,0.22); }
    .copy-btn:active { transform: translateY(0.8px); }
    .copy-btn:focus-visible { outline: none; box-shadow: var(--focus-ring); border-color: rgb(var(--accent-rgb)); }

    .extra-actions { display: grid; grid-template-columns: 1fr; gap: 12px; width: 100%; justify-self: stretch; margin-top: 4px; }

    /* Floating X button (opens message modal) */
    .fab-x {
      position: fixed;
      right: 24px;
      bottom: 24px;
      width: 56px;
      height: 56px;
      border-radius: 9999px;
      background: linear-gradient(180deg, var(--surface), var(--surface-2));
      border: 1px solid var(--border);
      color: var(--text);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      text-decoration: none;
      box-shadow: 0 10px 30px rgba(0,0,0,0.35);
      transition: transform 120ms ease, border-color 160ms ease, box-shadow 160ms ease, background 160ms ease;
      z-index: 20;
      cursor: pointer;
    }
    .fab-x:hover {
      border-color: rgba(255,255,255,0.25);
      box-shadow: 0 14px 40px rgba(0,0,0,0.45), 0 0 0 6px rgb(var(--accent-rgb) / 0.12) inset;
      transform: translateY(-1px);
    }
    .fab-x:focus-visible { outline: none; box-shadow: var(--focus-ring), 0 10px 30px rgba(0,0,0,0.35); }
    .fab-x svg { width: 22px; height: 22px; display: block; }

    /* Footer: enforce no background/effects */
    footer {
      width: min(92vw, 860px);
      margin: 20px auto 36px;
      color: hsl(160 12% 78%);
      font-size: 13px;
      line-height: 1.55;
      text-shadow: 0 1px 1px rgba(0,0,0,0.25);
      background: transparent !important;
      border: none !important;
      box-shadow: none !important;
      backdrop-filter: none !important;
    }
    footer *, footer p { background: transparent !important; }
    footer a {
      color: rgb(var(--accent2-rgb));
      text-decoration: none;
      border-bottom: 1px dashed transparent;
      cursor: pointer;
    }
    footer a:hover { color: rgb(var(--accent-rgb)); border-color: rgb(var(--accent-rgb) / 0.4); }
    footer a:focus-visible { outline: none; box-shadow: var(--focus-ring); border-radius: 6px; padding: 2px 4px; }

    .visually-hidden {
      position: absolute !important; height: 1px; width: 1px;
      overflow: hidden; clip: rect(1px, 1px, 1px, 1px);
      white-space: nowrap; border: 0; padding: 0; margin: -1px;
    }

    /* Image modal (footer "click here") */
    .modal-backdrop {
      position: fixed; inset: 0; background: rgba(0,0,0,0.6);
      display: none; align-items: center; justify-content: center; z-index: 50;
    }
    .modal-backdrop.open { display: flex; }
    .modal-dialog {
      background: hsl(165 20% 12% / 0.9);
      border: 1px solid var(--border);
      border-radius: 14px;
      box-shadow: var(--shadow-lg);
      max-width: min(90vw, 720px);
      max-height: min(80vh, 720px);
      overflow: hidden;
      position: relative;
      backdrop-filter: blur(6px) saturate(1.05);
    }
    .modal-content { display: grid; place-items: center; padding: 10px; background: transparent; }
    .modal-content img { max-width: 100%; max-height: 78vh; display: block; border-radius: 8px; }
    .modal-close {
      position: absolute; top: 10px; right: 10px; padding: 8px 10px; border-radius: 10px;
      border: 1px solid var(--border);
      background: linear-gradient(180deg, var(--surface), var(--surface-2));
      color: var(--text); font-weight: 600; cursor: pointer;
    }
    .modal-close:hover { border-color: rgba(255,255,255,0.25); }
    .modal-close:focus-visible { outline: none; box-shadow: var(--focus-ring); }

    /* Message modal (X button flow) */
    .msg-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.6); display: none; align-items: center; justify-content: center; z-index: 60; }
    .msg-backdrop.open { display: flex; }
    .msg-dialog {
      background: hsl(165 20% 12% / 0.95);
      border: 1px solid var(--border);
      border-radius: 14px;
      box-shadow: var(--shadow-lg);
      width: min(92vw, 520px);
      padding: 16px;
      display: grid; gap: 10px;
      backdrop-filter: blur(6px) saturate(1.05);
    }
    .msg-title { font: 700 18px/1.2 "Inter", system-ui, sans-serif; margin: 4px 0 2px; }
    .msg-input {
      width: 100%; min-height: 96px; max-height: 180px; resize: vertical;
      padding: 12px 12px;
      border-radius: 12px; border: 1px solid var(--border);
      background: linear-gradient(180deg, var(--surface), var(--surface-2)); color: var(--text);
      font: 500 15px/1.4 "Manrope", "Inter", system-ui, sans-serif;
    }
    .msg-actions { display: flex; gap: 10px; justify-content: flex-end; align-items: center; }
    .msg-count { color: var(--subtext); font: 500 12px/1 "Inter", system-ui, sans-serif; margin-right: auto; }
    .msg-btn {
      padding: 10px 14px; border-radius: 10px;
      border: 1px solid var(--border);
      background: linear-gradient(180deg, var(--surface), var(--surface-2));
      color: var(--text); font-weight: 700; cursor: pointer;
    }
    .msg-btn:disabled { opacity: 0.6; cursor: not-allowed; }
    .msg-btn:hover:not(:disabled) { border-color: rgba(255,255,255,0.25); }
    .msg-btn:focus-visible { outline: none; box-shadow: var(--focus-ring); }

    /* Floating chat bubble */
    .chat-bubble {
      position: fixed;
      z-index: 40;
      pointer-events: none;
      will-change: transform, opacity;
      width: 240px; height: 130px;
      left: 0; top: 0;
      transform: translate(-100vw, 100vh) scale(0.96);
      opacity: 0;
    }
    .chat-bubble .bubble-svg {
      width: 100%; height: 100%; display: block;
      filter: drop-shadow(0 10px 30px rgba(0,0,0,0.35));
    }
    .chat-bubble .bubble-text {
      position: absolute; inset: 0; display: grid; place-items: center; padding: 12px 16px;
      color: #111; font: 700 16px/1.2 "Manrope", "Inter", system-ui, sans-serif; text-align: center;
      text-shadow: none; word-break: break-word;
    }

    @keyframes floatUp {
      0%   { transform: translate(var(--start-x), var(--start-y)) scale(0.96); opacity: 0; }
      10%  { opacity: 1; }
      100% { transform: translate(var(--end-x), -10vh) scale(1.0); opacity: 0; }
    }
    .chat-bubble.animate { animation: floatUp 8s ease-in forwards; }

    @media (max-width: 720px) {
      .cta-row { grid-template-columns: 1fr; }
      .contract-strip { grid-template-columns: 1fr; gap: 10px; }
      .copy-btn { width: 100%; }
      .container { padding: 22px 18px 18px; }
      .fab-x { right: 18px; bottom: 18px; width: 52px; height: 52px; }
      .chat-bubble { width: 210px; height: 118px; }
    }
  </style>
</head>
<body>
  <!-- Eyes canvas -->
  <canvas id="bg-eyes" aria-hidden="true"></canvas>

  <main>
    <section class="container" id="spawn-container" aria-labelledby="hero-heading">
      <h1 id="hero-heading" aria-label="Web3 opaque asset hindsight $WOAH">
        <span class="hero-lines">
          <span class="hero-line">Web3 opaque</span>
          <span class="hero-line">asset hindsight</span>
          <span class="hero-tag">$WOAH!</span>
        </span>
      </h1>

      <div class="subtext">
        <p>Pay to undress them.</p>
        <p>Hold to $WOAH.</p>
      </div>

      <nav class="cta-row" aria-label="Primary calls to action">
        <a class="btn primary" href="https://pump.fun" target="_blank" rel="noopener noreferrer" aria-label="Buy now (opens in a new tab)">Buy Now</a>
        <a class="btn" href="https://dexscreener.com" target="_blank" rel="noopener noreferrer" aria-label="View on DEX Screener (opens in a new tab)">View on DEX Screener</a>
      </nav>

      <div class="contract-strip" role="group" aria-labelledby="contract-label">
        <div class="contract-meta">
          <span class="contract-label" id="contract-label">Contract Address</span>
          <div class="contract-value" id="contract-address" data-address="mycontract">mycontract</div>
        </div>
        <button class="copy-btn" id="copy-button" type="button" aria-live="polite" aria-label="Copy contract address to clipboard">Copy</button>
      </div>

      <nav class="extra-actions" aria-label="Extra actions">
        <a class="btn" href="https://web.telegram.org" target="_blank" aria-label="TRY IT">TRY IT</a>
      </nav>
    </section>
  </main>

  <!-- X button (opens message modal) -->
  <button class="fab-x" id="fab-x" title="Send a message" aria-label="Send a message">
    <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
      <path fill="currentColor" d="M18.3 2h3.2L14 10.3l8.2 11.7h-6.5L12 14.7 6.2 22H2.8L10 12.9 2 2h6.5l4.7 6.8L18.3 2z"/>
    </svg>
  </button>

  <footer>
    <p>No community. No tokenomics. Just send nudes.</p>
    <p>
      Disclaimer: Use with caution. In case of extreme usage,
      <a href="#" class="modal-link"
         data-modal-src="https://i.kym-cdn.com/entries/icons/original/000/033/758/Screen_Shot_2020-04-28_at_12.21.48_PM.png">
        click here.
      </a> No rights reserved.
    </p>
  </footer>

  <!-- In-page image modal -->
  <div class="modal-backdrop" id="image-modal" role="dialog" aria-modal="true" aria-labelledby="image-modal-title" aria-hidden="true">
    <div class="modal-dialog">
      <button class="modal-close" id="modal-close" aria-label="Close">Close</button>
      <div class="modal-content">
        <img id="modal-img" alt="Preview">
      </div>
    </div>
  </div>

  <!-- Message modal -->
  <div class="msg-backdrop" id="msg-modal" role="dialog" aria-modal="true" aria-labelledby="msg-title" aria-hidden="true">
    <div class="msg-dialog">
      <div class="msg-title" id="msg-title">Send a message</div>
      <textarea id="msg-input" class="msg-input" maxlength="100" placeholder="Type up to 100 characters..."></textarea>
      <div class="msg-actions">
        <div class="msg-count" id="msg-count">0 / 100</div>
        <button class="msg-btn" id="msg-cancel" type="button">Cancel</button>
        <button class="msg-btn" id="msg-send" type="button" disabled>Send</button>
      </div>
    </div>
  </div>

  <!-- Live region for accessibility feedback -->
  <div class="visually-hidden" role="status" aria-live="polite" id="sr-feedback"></div>

  <script>
    // Constants: Supabase configuration
    const SUPABASE_URL = 'https://rpezcqtbvcigwkfhdiqy.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJwZXpjcXRidmNpZ3drZmhkaXF5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY1NzM4MDMsImV4cCI6MjA3MjE0OTgwM30.buOFS-VY6Pc2PsVs-7aQYfrei0YhWniuvhl7M_lm-fc';

    (function () {
      // Safe access to Supabase UMD
      const { createClient } = window.supabase || {};
      const supa = createClient ? createClient(SUPABASE_URL, SUPABASE_ANON_KEY) : null;

      // Elements and helpers
      const canvas = document.getElementById('bg-eyes');
      const ctx = canvas.getContext('2d', { alpha: true });
      const container = document.getElementById('spawn-container');

      const imageModal = document.getElementById('image-modal');
      const modalImg = document.getElementById('modal-img');
      const modalClose = document.getElementById('modal-close');

      const fabX = document.getElementById('fab-x');
      const msgModal = document.getElementById('msg-modal');
      const msgInput = document.getElementById('msg-input');
      const msgSend = document.getElementById('msg-send');
      const msgCancel = document.getElementById('msg-cancel');
      const msgCount = document.getElementById('msg-count');
      const srFeedback = document.getElementById('sr-feedback');

      const copyBtn = document.getElementById('copy-button');
      const addrEl = document.getElementById('contract-address');

      const mqReduced = window.matchMedia('(prefers-reduced-motion: reduce)');
      const hasReduced = mqReduced.matches;
      const mqFine = window.matchMedia('(pointer: fine)');

      function announce(text) { if (srFeedback) srFeedback.textContent = text; }

      // Copy Address
      function setCopyFeedback(text) {
        if (copyBtn) copyBtn.textContent = text;
        announce(text);
      }
      async function copyAddress() {
        const address = (addrEl?.dataset.address || addrEl?.textContent || '').trim();
        if (!address) return;
        let success = false;
        try {
          if (navigator.clipboard?.writeText) { await navigator.clipboard.writeText(address); success = true; }
          else { throw new Error('Clipboard API unavailable'); }
        } catch {
          try {
            const ta = document.createElement('textarea');
            ta.value = address; ta.setAttribute('readonly',''); ta.style.position='fixed'; ta.style.top='-9999px';
            document.body.appendChild(ta); ta.select();
            success = document.execCommand && document.execCommand('copy');
            document.body.removeChild(ta);
          } catch { success = false; }
        }
        const original = 'Copy';
        setCopyFeedback(success ? 'Copied!' : 'Copy failed');
        setTimeout(() => setCopyFeedback(original), 1200);
      }
      if (copyBtn) copyBtn.addEventListener('click', copyAddress);

      // Footer image modal
      document.querySelectorAll('.modal-link').forEach(link => {
        link.addEventListener('click', (e) => {
          e.preventDefault();
          const src = link.getAttribute('data-modal-src') || link.href;
          modalImg.src = src;
          imageModal.classList.add('open');
          imageModal.setAttribute('aria-hidden', 'false');
        });
      });
      modalClose.addEventListener('click', () => {
        imageModal.classList.remove('open');
        imageModal.setAttribute('aria-hidden', 'true');
        modalImg.src = '';
      });
      imageModal.addEventListener('click', (e) => {
        if (e.target === imageModal) {
          imageModal.classList.remove('open');
          imageModal.setAttribute('aria-hidden', 'true');
          modalImg.src = '';
        }
      });
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          imageModal.classList.remove('open');
          imageModal.setAttribute('aria-hidden', 'true');
          modalImg.src = '';
        }
      });

      // Message modal (X button)
      function openMsgModal() {
        msgInput.value = '';
        msgCount.textContent = '0 / 100';
        msgSend.disabled = true;
        msgModal.classList.add('open');
        msgModal.setAttribute('aria-hidden', 'false');
        setTimeout(() => msgInput.focus(), 0);
      }
      function closeMsgModal() {
        msgModal.classList.remove('open');
        msgModal.setAttribute('aria-hidden', 'true');
      }
      fabX.addEventListener('click', (e) => { e.preventDefault(); openMsgModal(); });
      msgInput.addEventListener('input', () => {
        const len = msgInput.value.length;
        msgCount.textContent = len + ' / 100';
        msgSend.disabled = (len === 0 || len > 100);
      });
      msgCancel.addEventListener('click', closeMsgModal);

      // Floating chat bubble
      function spawnChatBubble(text) {
        const bubble = document.createElement('div');
        bubble.className = 'chat-bubble';

        const skin = getComputedStyle(document.documentElement).getPropertyValue('--skin').trim() || '#FAD6BE';
        const svg = `
<svg class="bubble-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 130" preserveAspectRatio="xMidYMid meet" aria-hidden="true">
  <g fill="none" stroke="#000" stroke-width="5">
    <circle cx="100" cy="65" r="48" fill="${skin}"/>
    <circle cx="140" cy="65" r="48" fill="${skin}"/>
  </g>
</svg>`;
        bubble.innerHTML = svg + '<div class="bubble-text"></div>';
        bubble.querySelector('.bubble-text').textContent = text;

        document.body.appendChild(bubble);

        // Start position: near the X (fab) button
        const fabRect = fabX.getBoundingClientRect();
        const startX = Math.max(8, fabRect.left - 160 + fabRect.width / 2);
        const startY = Math.max(8, fabRect.top - 30);
        const endX = Math.max(20, window.innerWidth * 0.25 - 60);

        bubble.style.setProperty('--start-x', startX + 'px');
        bubble.style.setProperty('--start-y', startY + 'px');
        bubble.style.setProperty('--end-x', endX + 'px');

        bubble.classList.add('animate');
        bubble.addEventListener('animationend', () => bubble.remove(), { once: true });
      }

      // Supabase Realtime: setup
      const LOCAL_SOURCE_ID_KEY = 'woah_source_id';
      function uuidv4() {
        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
          const r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);
          return v.toString(16);
        });
      }
      let sourceId = localStorage.getItem(LOCAL_SOURCE_ID_KEY);
      if (!sourceId) {
        sourceId = uuidv4();
        localStorage.setItem(LOCAL_SOURCE_ID_KEY, sourceId);
      }

      let lastSend = 0;
      const SEND_INTERVAL_MS = 4000;

      async function handleSend() {
        const now = Date.now();
        if (now - lastSend < SEND_INTERVAL_MS) {
          announce('Please wait a few seconds before sending another message.');
          return;
        }
        const text = msgInput.value.trim().slice(0, 100);
        if (text.length < 1 || text.length > 100) return;

        lastSend = now;
        closeMsgModal();

        // Show locally immediately
        spawnChatBubble(text);

        // Insert into Supabase
        if (supa) {
          try {
            const { error } = await supa.from('messages').insert([{ text, source_id: sourceId }]);
            if (error) announce('Send failed: ' + error.message);
          } catch (err) {
            announce('Send failed.');
          }
        }
      }
      msgSend.addEventListener('click', handleSend);

      // Subscribe to realtime inserts
      if (supa) {
        (async () => {
          try {
            const channel = supa.channel('public-messages')
              .on('postgres_changes', { event: 'INSERT', schema: 'public', table: 'messages' }, (payload) => {
                try {
                  const row = payload.new || payload.record || {};
                  const text = String(row.text || '').slice(0, 100);
                  const src = row.source_id || '';
                  if (!text) return;
                  if (src === sourceId) return; // avoid echo of own message
                  spawnChatBubble(text);
                } catch (_e) {}
              });

            const status = await channel.subscribe();
            if (status !== 'SUBSCRIBED') {
              // Soft hint if subscription not fully established
              console.warn('Supabase Realtime not SUBSCRIBED:', status);
            }
          } catch (e) {
            console.error('Supabase subscribe failed:', e);
          }
        })();
      }

      // ============ Interactive Eyes Canvas ============
      let dpr = 1;
      let containerRect = container.getBoundingClientRect();

      function updateContainerRect() { containerRect = container.getBoundingClientRect(); }

      function sizeCanvas() {
        dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
        const w = window.innerWidth, h = window.innerHeight;
        canvas.width = Math.floor(w * dpr); canvas.height = Math.floor(h * dpr);
        canvas.style.width = w + 'px'; canvas.style.height = h + 'px';
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
        updateContainerRect();
        relayoutAllPairs();
        if (hasReduced) drawOnce();
      }

      const pairs = [];
      let baseRadius = 40;

      function computeBaseRadius() {
        const w = canvas.clientWidth, h = canvas.clientHeight;
        baseRadius = Math.max(24, Math.min(80, Math.floor(Math.min(w, h) * 0.08)));
      }

      // Allow up to 40% of radius outside container
      const overflowFraction = 0.4;

      function clampPairCenterToContainer(center, r, sep) {
        const insideMargin = r * (1 - overflowFraction); // 0.6r inside container
        const cxMin = (containerRect.left + insideMargin) + sep / 2;
        const cxMax = (containerRect.right - insideMargin) - sep / 2;
        const cyMin = containerRect.top + insideMargin;
        const cyMax = containerRect.bottom - insideMargin;

        const minX = Math.min(cxMin, cxMax);
        const maxX = Math.max(cxMin, cxMax);
        const minY = Math.min(cyMin, cyMax);
        const maxY = Math.max(cyMin, cyMax);

        center.x = Math.min(Math.max(center.x, minX), maxX);
        center.y = Math.min(Math.max(center.y, minY), maxY);
        return center;
      }

      function createPairAt(x, y) {
        computeBaseRadius();
        const r = baseRadius;

        const gap = -Math.floor(r * 0.35); // negative gap for overlap
        const separation = r * 2 + gap;

        const center = clampPairCenterToContainer({ x, y }, r, separation);

        const leftCx = center.x - separation / 2;
        const rightCx = center.x + separation / 2;
        const cy = center.y;

        const pupilR = Math.floor(r * 0.38);
        const margin = Math.max(2, Math.floor(r * 0.04));

        const pair = {
          center,
          r,
          separation,
          pupilR,
          margin,
          lineW: Math.max(2, Math.min(4, Math.floor(r * 0.06))),
          eyes: [
            { cx: leftCx, cy, r, pupil: { x: leftCx, y: cy } },
            { cx: rightCx, cy, r, pupil: { x: rightCx, y: cy } }
          ]
        };
        pairs.push(pair);
      }

      function relayoutPair(pair) {
        computeBaseRadius();
        pair.r = baseRadius;
        pair.pupilR = Math.floor(pair.r * 0.38);
        pair.margin = Math.max(2, Math.floor(pair.r * 0.04));
        const gap = -Math.floor(pair.r * 0.35);
        pair.separation = pair.r * 2 + gap;
        pair.lineW = Math.max(2, Math.min(4, Math.floor(pair.r * 0.06)));

        clampPairCenterToContainer(pair.center, pair.r, pair.separation);

        const leftCx = pair.center.x - pair.separation / 2;
        const rightCx = pair.center.x + pair.separation / 2;
        const cy = pair.center.y;

        pair.eyes[0].cx = leftCx; pair.eyes[0].cy = cy; pair.eyes[0].r = pair.r;
        pair.eyes[1].cx = rightCx; pair.eyes[1].cy = cy; pair.eyes[1].r = pair.r;

        pair.eyes[0].pupil.x = leftCx; pair.eyes[0].pupil.y = cy;
        pair.eyes[1].pupil.x = rightCx; pair.eyes[1].pupil.y = cy;
      }

      function relayoutAllPairs() { for (let i = 0; i < pairs.length; i++) relayoutPair(pairs[i]); }

      function containerCenter() {
        return { x: containerRect.left + containerRect.width / 2, y: containerRect.top + containerRect.height * 0.42 };
      }
      updateContainerRect();
      const c0 = containerCenter();
      createPairAt(c0.x, c0.y);

      // Pointer tracking
      let autopilot = !mqFine.matches;
      let pointerX = c0.x, pointerY = c0.y;

      function onPointerMove(ev) { if (hasReduced) return; autopilot = false; pointerX = ev.clientX; pointerY = ev.clientY; if (!running) start(); }
      function onPointerLeave() { if (hasReduced) return; const c = containerCenter(); pointerX = c.x; pointerY = c.y; if (!running) start(); }
      function onContainerPointerDown(ev) {
        const x = ev.clientX, y = ev.clientY;
        updateContainerRect();
        if (x >= containerRect.left && x <= containerRect.right && y >= containerRect.top && y <= containerRect.bottom) {
          createPairAt(x, y); pointerX = x; pointerY = y; if (hasReduced) drawOnce(); else if (!running) start();
        }
      }

      function autoTarget(time) {
        const cx = containerRect.left + containerRect.width / 2;
        const cy = containerRect.top + containerRect.height / 2;
        const ax = (Math.sin(time * 0.6) + Math.sin(time * 0.31 + 1.1)) * 0.25;
        const ay = (Math.cos(time * 0.43) + Math.sin(time * 0.21 + 0.7)) * 0.25;
        const maxX = Math.min(containerRect.width * 0.25, 160);
        const maxY = Math.min(containerRect.height * 0.22, 140);
        pointerX = cx + maxX * ax; pointerY = cy + maxY * ay;
      }

      function lerp(a, b, t) { return a + (b - a) * t; }

      // Drawing utilities
      function drawEyeball(eye, lineW) {
        const { cx, cy, r } = eye;

        // Drop shadow
        ctx.save();
        ctx.beginPath(); ctx.arc(cx, cy, r, 0, Math.PI * 2);
        ctx.shadowColor = 'rgba(0, 0, 0, 0.35)'; ctx.shadowBlur = r * 0.6; ctx.shadowOffsetY = r * 0.12;
        ctx.fillStyle = 'rgba(0,0,0,0)'; ctx.fill();
        ctx.restore();

        // Base
        ctx.beginPath(); ctx.arc(cx, cy, r, 0, Math.PI * 2);
        ctx.fillStyle = 'rgba(250, 214, 190, 0.98)'; ctx.fill();
        ctx.lineWidth = lineW; ctx.strokeStyle = 'rgba(0,0,0,0.9)'; ctx.stroke();

        // Highlight
        const gH = ctx.createRadialGradient(cx - r * 0.35, cy - r * 0.35, 0, cx - r * 0.35, cy - r * 0.35, r);
        gH.addColorStop(0.0, 'rgba(255,255,255,0.38)'); gH.addColorStop(0.5, 'rgba(255,255,255,0.12)'); gH.addColorStop(1.0, 'rgba(255,255,255,0.00)');
        ctx.fillStyle = gH; ctx.beginPath(); ctx.arc(cx, cy, r, 0, Math.PI * 2); ctx.fill();

        // Shadow
        const gS = ctx.createRadialGradient(cx + r * 0.35, cy + r * 0.35, 0, cx + r * 0.35, cy + r * 0.35, r);
        gS.addColorStop(0.0, 'rgba(0,0,0,0.24)'); gS.addColorStop(0.6, 'rgba(0,0,0,0.10)'); gS.addColorStop(1.0, 'rgba(0,0,0,0.00)');
        ctx.fillStyle = gS; ctx.beginPath(); ctx.arc(cx, cy, r, 0, Math.PI * 2); ctx.fill();

        // Rim
        const rim = ctx.createRadialGradient(cx, cy, r * 0.6, cx, cy, r);
        rim.addColorStop(0, 'rgba(0,0,0,0)'); rim.addColorStop(1, 'rgba(0,0,0,0.14)');
        ctx.fillStyle = rim; ctx.beginPath(); ctx.arc(cx, cy, r, 0, Math.PI * 2); ctx.fill();
      }

      function drawPupil(eye, pupilR, lineW) {
        const px = eye.pupil.x, py = eye.pupil.y;
        const pg = ctx.createRadialGradient(px, py, 0, px, py, pupilR);
        pg.addColorStop(0.0, 'rgba(255, 79, 138, 1)'); pg.addColorStop(0.6, 'rgba(255, 112, 158, 0.92)'); pg.addColorStop(1.0, 'rgba(255, 158, 188, 0.85)');
        ctx.fillStyle = pg; ctx.beginPath(); ctx.arc(px, py, pupilR, 0, Math.PI * 2); ctx.fill();
        ctx.lineWidth = lineW; ctx.strokeStyle = 'rgba(0,0,0,0.9)'; ctx.stroke();

        // Center highlight dot
        const hr = Math.max(2, pupilR * 0.22);
        ctx.beginPath(); ctx.arc(px, py, hr, 0, Math.PI * 2);
        ctx.fillStyle = 'rgba(255, 192, 203, 0.96)'; ctx.fill();
        ctx.lineWidth = Math.max(1.6, lineW * 0.8); ctx.strokeStyle = 'rgba(0,0,0,0.9)'; ctx.stroke();
      }

      function updatePupils() {
        for (let i = 0; i < pairs.length; i++) {
          const pair = pairs[i];
          const { pupilR, margin } = pair;
          for (let j = 0; j < pair.eyes.length; j++) {
            const eye = pair.eyes[j];
            const { cx, cy, r } = eye;

            const dx = pointerX - cx;
            const dy = pointerY - cy;
            const dist = Math.hypot(dx, dy) || 1;

            const maxOffset = Math.max(0, r - pupilR - margin);
            const ux = dx / dist;
            const uy = dy / dist;
            const tx = cx + ux * Math.min(dist, maxOffset);
            const ty = cy + uy * Math.min(dist, maxOffset);

            eye.pupil.x = lerp(eye.pupil.x, tx, 0.18);
            eye.pupil.y = lerp(eye.pupil.y, ty, 0.18);
          }
        }
      }

      function drawEyesFrameTwoPass() {
        const w = canvas.clientWidth, h = canvas.clientHeight;
        ctx.clearRect(0, 0, w, h);

        // Pass 1: eyeballs
        for (let i = 0; i < pairs.length; i++) {
          const pair = pairs[i];
          drawEyeball(pair.eyes[0], pair.lineW);
          drawEyeball(pair.eyes[1], pair.lineW);
        }

        // Pass 2: pupils
        for (let i = 0; i < pairs.length; i++) {
          const pair = pairs[i];
          drawPupil(pair.eyes[0], pair.pupilR, pair.lineW);
          drawPupil(pair.eyes[1], pair.pupilR, pair.lineW);
        }
      }

      function drawStaticFrameTwoPass() {
        const w = canvas.clientWidth, h = canvas.clientHeight;
        ctx.clearRect(0, 0, w, h);

        // Center pupils first
        for (let i = 0; i < pairs.length; i++) {
          const p = pairs[i];
          p.eyes[0].pupil.x = p.eyes[0].cx; p.eyes[0].pupil.y = p.eyes[0].cy;
          p.eyes[1].pupil.x = p.eyes[1].cx; p.eyes[1].pupil.y = p.eyes[1].cy;
        }

        // Eyeballs then pupils
        for (let i = 0; i < pairs.length; i++) {
          const pair = pairs[i];
          drawEyeball(pair.eyes[0], pair.lineW);
          drawEyeball(pair.eyes[1], pair.lineW);
        }
        for (let i = 0; i < pairs.length; i++) {
          const pair = pairs[i];
          drawPupil(pair.eyes[0], pair.pupilR, pair.lineW);
          drawPupil(pair.eyes[1], pair.pupilR, pair.lineW);
        }
      }
      function drawOnce() { drawStaticFrameTwoPass(); }

      // Animation loop
      let running = false, raf = 0;
      function draw(t) {
        const time = t * 0.001;
        if (autopilot && !hasReduced) autoTarget(time);
        updatePupils();
        drawEyesFrameTwoPass();
        if (!hasReduced) {
          raf = requestAnimationFrame(draw);
        } else {
          running = false;
        }
      }
      function start() { if (running || hasReduced) return; running = true; cancelAnimationFrame(raf); raf = requestAnimationFrame(draw); }

      // Init sizes and listeners
      sizeCanvas();
      if (!hasReduced) start(); else drawOnce();

      window.addEventListener('resize', () => { sizeCanvas(); }, { passive: true });
      window.addEventListener('scroll', () => { updateContainerRect(); relayoutAllPairs(); if (hasReduced) drawOnce(); }, { passive: true });
      window.addEventListener('pointermove', onPointerMove, { passive: true });
      window.addEventListener('pointerleave', onPointerLeave, { passive: true });
      container.addEventListener('pointerdown', onContainerPointerDown, { passive: true });

    })();
  </script>
</body>
</html>

